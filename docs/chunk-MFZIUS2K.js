import{a as R,b as L,c as z,d as H,e as J,f as K,g as Q}from"./chunk-TRJWZQLT.js";import{a as E,b as y}from"./chunk-QWOEQOT6.js";import{b as S,k as F,m as x}from"./chunk-4IHK7A7Q.js";import{a as k,c as I,f as q,g as N,h as g,j as T,k as U,o as B,p as V,q as D,r as G,s as j,t as A}from"./chunk-RPOBVP67.js";import{l as b,m as v}from"./chunk-OCQY2TLL.js";import"./chunk-V7N3IQWY.js";import{Cb as _,Db as M,Nb as i,Pb as w,Ua as a,Za as u,eb as P,ib as c,pb as s,pc as h,sc as O,ub as o,vb as t,wb as p}from"./chunk-MMUXBZSV.js";function X(e,n){e&1&&(o(0,"mat-error"),i(1," Username is required "),t())}function Y(e,n){e&1&&(o(0,"mat-error"),i(1," Username must be at least 3 characters "),t())}function Z(e,n){e&1&&(o(0,"mat-error"),i(1," Email is required "),t())}function $(e,n){e&1&&(o(0,"mat-error"),i(1," Please enter a valid email address "),t())}function tt(e,n){e&1&&(o(0,"mat-error"),i(1," Current password is required "),t())}function et(e,n){e&1&&(o(0,"mat-error"),i(1," New password is required "),t())}function nt(e,n){e&1&&(o(0,"mat-error"),i(1," Password must be at least 8 characters "),t())}function rt(e,n){e&1&&(o(0,"mat-error"),i(1," Passwords do not match "),t())}function ot(e,n){if(e&1&&(o(0,"mat-card",11)(1,"mat-card-content")(2,"mat-form-field",2)(3,"mat-label"),i(4,"Current Password"),t(),p(5,"input",12),c(6,tt,2,0,"mat-error",4),t(),o(7,"mat-form-field",2)(8,"mat-label"),i(9,"New Password"),t(),p(10,"input",13),o(11,"mat-hint"),i(12,"Minimum 8 characters"),t(),c(13,et,2,0,"mat-error",4)(14,nt,2,0,"mat-error",4),t(),o(15,"mat-form-field",2)(16,"mat-label"),i(17,"Confirm New Password"),t(),p(18,"input",14),c(19,rt,2,0,"mat-error",4),t()()()),e&2){let m,r,d,l=M();a(6),s("ngIf",(m=l.settingsForm.get("currentPassword"))==null?null:m.hasError("required")),a(4),s("required",l.showPasswordFields),a(3),s("ngIf",(r=l.settingsForm.get("newPassword"))==null?null:r.hasError("required")),a(),s("ngIf",(d=l.settingsForm.get("newPassword"))==null?null:d.hasError("minlength")),a(4),s("required",l.showPasswordFields),a(),s("ngIf",l.settingsForm.hasError("passwordMismatch"))}}function it(e,n){e&1&&(o(0,"span"),i(1,"Save Changes"),t())}function at(e,n){e&1&&(o(0,"span"),p(1,"mat-spinner",15),i(2," Saving... "),t())}var W=class e{constructor(n,m,r,d){this.fb=n;this.authService=m;this.router=r;this.snackBar=d;this.settingsForm=this.fb.group({username:["",[g.required,g.minLength(3)]],email:["",[g.required,g.email]],currentPassword:[""],newPassword:["",[g.minLength(8)]],confirmPassword:[""]},{validator:this.passwordMatchValidator})}settingsForm;isSubmitting=!1;currentUser;showPasswordFields=!1;ngOnInit(){this.currentUser=this.authService.currentUserValue,this.currentUser&&this.settingsForm.patchValue({username:this.currentUser.username,email:this.currentUser.email})}passwordMatchValidator(n){let m=n.get("newPassword")?.value,r=n.get("confirmPassword")?.value;return m&&r&&m!==r?(n.get("confirmPassword")?.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):null}togglePasswordFields(){this.showPasswordFields=!this.showPasswordFields,this.showPasswordFields||this.settingsForm.patchValue({currentPassword:"",newPassword:"",confirmPassword:""})}onSubmit(){if(this.settingsForm.invalid)return;this.isSubmitting=!0;let n=this.settingsForm.value,m={username:n.username,email:n.email};n.newPassword&&(m.currentPassword=n.currentPassword,m.newPassword=n.newPassword),this.authService.updateUser(m).subscribe({next:()=>{this.snackBar.open("Settings updated successfully!","Close",{duration:3e3}),this.isSubmitting=!1,this.showPasswordFields=!1},error:r=>{this.snackBar.open(r.message||"Failed to update settings","Close",{duration:3e3}),this.isSubmitting=!1}})}onCancel(){this.router.navigate(["/home"])}static \u0275fac=function(m){return new(m||e)(u(j),u(x),u(S),u(F))};static \u0275cmp=P({type:e,selectors:[["app-settings"]],decls:25,vars:10,consts:[[1,"settings-container"],[1,"settings-form",3,"ngSubmit","formGroup"],["appearance","outline"],["matInput","","formControlName","username","required",""],[4,"ngIf"],["matInput","","formControlName","email","type","email","required",""],["mat-button","","type","button","color","primary",3,"click"],["class","password-card",4,"ngIf"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-button","","type","button",3,"click"],[1,"password-card"],["matInput","","formControlName","currentPassword","type","password","autocomplete","current-password","required",""],["matInput","","formControlName","newPassword","type","password","autocomplete","new-password",3,"required"],["matInput","","formControlName","confirmPassword","type","password","autocomplete","new-password",3,"required"],["diameter","20"]],template:function(m,r){if(m&1&&(o(0,"div",0)(1,"h1"),i(2,"Account Settings"),t(),o(3,"form",1),_("ngSubmit",function(){return r.onSubmit()}),o(4,"mat-form-field",2)(5,"mat-label"),i(6,"Username"),t(),p(7,"input",3),c(8,X,2,0,"mat-error",4)(9,Y,2,0,"mat-error",4),t(),o(10,"mat-form-field",2)(11,"mat-label"),i(12,"Email"),t(),p(13,"input",5),c(14,Z,2,0,"mat-error",4)(15,$,2,0,"mat-error",4),t(),o(16,"button",6),_("click",function(){return r.togglePasswordFields()}),i(17),t(),c(18,ot,20,6,"mat-card",7),o(19,"div",8)(20,"button",9),c(21,it,2,0,"span",4)(22,at,3,0,"span",4),t(),o(23,"button",10),_("click",function(){return r.onCancel()}),i(24,"Cancel"),t()()()()),m&2){let d,l,f,C;a(3),s("formGroup",r.settingsForm),a(5),s("ngIf",(d=r.settingsForm.get("username"))==null?null:d.hasError("required")),a(),s("ngIf",(l=r.settingsForm.get("username"))==null?null:l.hasError("minlength")),a(5),s("ngIf",(f=r.settingsForm.get("email"))==null?null:f.hasError("required")),a(),s("ngIf",(C=r.settingsForm.get("email"))==null?null:C.hasError("email")),a(2),w(" ",r.showPasswordFields?"Cancel Password Change":"Change Password"," "),a(),s("ngIf",r.showPasswordFields),a(2),s("disabled",r.isSubmitting||r.settingsForm.invalid),a(),s("ngIf",!r.isSubmitting),a(),s("ngIf",r.isSubmitting)}},dependencies:[O,h,A,B,N,T,U,G,V,D,y,E,q,k,I,J,H,R,z,L,Q,K,v,b],styles:[".settings-container[_ngcontent-%COMP%], .password-card[_ngcontent-%COMP%]{max-width:600px;margin:2rem auto;padding:2rem;background-color:#f5f5f5cc;border-radius:8px;box-shadow:0 2px 10px #0000001a}.dark-mode[_nghost-%COMP%]   .settings-container[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .settings-container[_ngcontent-%COMP%], .dark-mode[_nghost-%COMP%]   .password-card[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .password-card[_ngcontent-%COMP%]{color:#f5f5f5;background-color:#1e1e1ecc}.dark-mode[_nghost-%COMP%]   .settings-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .settings-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .dark-mode[_nghost-%COMP%]   .password-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .password-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#f5f5f5;background-color:#27a737cc}.dark-mode[_nghost-%COMP%]   .settings-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .settings-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .dark-mode[_nghost-%COMP%]   .password-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .password-card[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#f5f5f5}.dark-mode[_nghost-%COMP%]   .settings-container[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .settings-container[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%], .dark-mode[_nghost-%COMP%]   .password-card[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .password-card[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]{color:#f5f5f599}.settings-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .password-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem;color:#27a737}.settings-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .password-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:1.5rem 0 1rem;color:#666}@media screen and (max-width: 576px){.settings-container[_ngcontent-%COMP%], .password-card[_ngcontent-%COMP%]{padding:1rem}}.settings-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.settings-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.dark-mode[_nghost-%COMP%]   .settings-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%], .dark-mode   [_nghost-%COMP%]   .settings-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{color:#f5f5f5}@media screen and (max-width: 576px){.settings-form[_ngcontent-%COMP%]{gap:.5rem}}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:1rem}@media screen and (max-width: 576px){.form-actions[_ngcontent-%COMP%]{gap:.5rem;font-size:small;justify-content:center;flex-direction:column}}"]})};export{W as SettingsComponent};
